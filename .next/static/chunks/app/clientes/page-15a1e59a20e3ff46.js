(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{8913:(e,s,t)=>{"use strict";t.d(s,{default:()=>k});var a=t(95155),r=t(12115),l=t(34486),i=t(71408),n=t(89559),c=t(6132),o=t(91169),d=t(61362),m=t(12181),x=t(1524),h=t(91761),u=t(86651),p=t(63581),g=t(39867),j=t(23664),b=t(69141),y=t(10512),f=t(16485),N=t(57828),v=t(20017),w=t(45345),C=t(27803);function k(){let[e,s]=(0,r.useState)({busca:"",status:"todos",segmento:"",tag:"",ordenacao:"ultimaCompra",direcao:"desc"}),[t,k]=(0,r.useState)(null),[A,S]=(0,r.useState)(!1),[E,M]=(0,r.useState)(1),{data:L,loading:P,error:T,refresh:D,isConnected:R}=(0,C._3)(),{customers:_,loading:F,reload:O}=(0,C.q2)(),[I,z]=(0,r.useState)([]),[B,V]=(0,r.useState)({total:0,ativos:0,inativos:0,novosEstesMes:0,ticketMedio:0,clvMedio:0});(0,r.useEffect)(()=>{if(_&&_.length>0){let e=_.map(e=>{let s=e.ultimaCompra?Math.floor((Date.now()-new Date(e.ultimaCompra).getTime())/864e5):999,t="Lost";s<=30&&e.numeroCompras>=5&&e.totalCompras>=1e3?t="Champions":s<=60&&e.numeroCompras>=3?t="Loyal":s<=90&&e.numeroCompras>=1?t="Potential":s<=180&&(t="At Risk");let a=e.numeroCompras>0?e.totalCompras/e.numeroCompras*e.numeroCompras*2.5:0;return{...e,rfmSegment:t,clv:a}});z(e);let s=new Date,t=new Date(s.getFullYear(),s.getMonth(),1);V({total:e.length,ativos:e.filter(e=>e.ativo).length,inativos:e.filter(e=>!e.ativo).length,novosEstesMes:e.filter(e=>new Date(e.createdAt)>=t).length,ticketMedio:e.reduce((e,s)=>e+(s.numeroCompras>0?s.totalCompras/s.numeroCompras:0),0)/e.length,clvMedio:e.reduce((e,s)=>e+(s.clv||0),0)/e.length})}},[_]);let q=[...I.filter(s=>(!e.busca||!!s.nome.toLowerCase().includes(e.busca.toLowerCase())||!!s.email.toLowerCase().includes(e.busca.toLowerCase()))&&("ativos"!==e.status||!!s.ativo)&&("inativos"!==e.status||!s.ativo)&&(!e.segmento||s.rfmSegment===e.segmento)&&(!e.tag||!!s.tags.includes(e.tag))&&!0)].sort((s,t)=>{let a,r;switch(e.ordenacao){case"nome":a=s.nome.toLowerCase(),r=t.nome.toLowerCase();break;case"ultimaCompra":a=s.ultimaCompra?new Date(s.ultimaCompra).getTime():0,r=t.ultimaCompra?new Date(t.ultimaCompra).getTime():0;break;case"totalCompras":a=s.totalCompras,r=t.totalCompras;break;case"numeroCompras":a=s.numeroCompras,r=t.numeroCompras;break;default:return 0}return"asc"===e.direcao?a>r?1:-1:a<r?1:-1}),J=Math.ceil(q.length/20),U=q.slice((E-1)*20,20*E),H=e=>{switch(e){case"Champions":return"bg-green-100 text-green-800";case"Loyal":return"bg-blue-100 text-blue-800";case"Potential":return"bg-yellow-100 text-yellow-800";case"At Risk":return"bg-orange-100 text-orange-800";case"Lost":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},K=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),Y=e=>new Date(e).toLocaleDateString("pt-BR");return P||F?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(n.A,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-500"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Carregando dados dos clientes..."})]})}):T?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(c.A,{className:"w-8 h-8 mx-auto mb-4 text-red-500"}),(0,a.jsxs)("p",{className:"text-red-600 mb-4",children:["Erro ao carregar dados: ",T]}),(0,a.jsx)("button",{onClick:D,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Tentar Novamente"})]})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[(0,a.jsx)(o.A,{className:"w-8 h-8 mr-3 text-blue-500"}),"Dashboard de Clientes"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"An\xe1lise completa da base de clientes com segmenta\xe7\xe3o RFM"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-lg ".concat(R?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:[R?(0,a.jsx)(d.A,{className:"w-4 h-4"}):(0,a.jsx)(c.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:R?"CRM Conectado":"CRM Desconectado"})]}),(0,a.jsxs)("button",{onClick:D,className:"flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[(0,a.jsx)(n.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Atualizar"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6",children:[(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total de Clientes"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:B.total.toLocaleString()})]}),(0,a.jsx)(o.A,{className:"w-8 h-8 text-blue-500"})]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Clientes Ativos"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:B.ativos.toLocaleString()})]}),(0,a.jsx)(m.A,{className:"w-8 h-8 text-green-500"})]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Novos Este M\xeas"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:B.novosEstesMes.toLocaleString()})]}),(0,a.jsx)(x.A,{className:"w-8 h-8 text-blue-500"})]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Ticket M\xe9dio"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:K(B.ticketMedio)})]}),(0,a.jsx)(h.A,{className:"w-8 h-8 text-purple-500"})]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"CLV M\xe9dio"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:K(B.clvMedio)})]}),(0,a.jsx)(x.A,{className:"w-8 h-8 text-orange-500"})]})}),(0,a.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Taxa de Ativa\xe7\xe3o"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-emerald-600",children:[(B.ativos/B.total*100).toFixed(1),"%"]})]}),(0,a.jsx)(d.A,{className:"w-8 h-8 text-emerald-500"})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0",children:[(0,a.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,a.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por nome ou email...",value:e.busca,onChange:e=>s(s=>({...s,busca:e.target.value})),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("select",{value:e.status,onChange:e=>s(s=>({...s,status:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"todos",children:"Todos os Status"}),(0,a.jsx)("option",{value:"ativos",children:"Apenas Ativos"}),(0,a.jsx)("option",{value:"inativos",children:"Apenas Inativos"})]}),(0,a.jsxs)("select",{value:e.segmento,onChange:e=>s(s=>({...s,segmento:e.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Todos os Segmentos"}),(0,a.jsx)("option",{value:"Champions",children:"Champions"}),(0,a.jsx)("option",{value:"Loyal",children:"Loyal"}),(0,a.jsx)("option",{value:"Potential",children:"Potential"}),(0,a.jsx)("option",{value:"At Risk",children:"At Risk"}),(0,a.jsx)("option",{value:"Lost",children:"Lost"})]}),(0,a.jsxs)("button",{onClick:()=>S(!A),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[(0,a.jsx)(p.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Filtros"})]}),(0,a.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:[(0,a.jsx)(g.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Exportar"})]})]})]}),(0,a.jsx)(i.N,{children:A&&(0,a.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordenar por"}),(0,a.jsxs)("select",{value:e.ordenacao,onChange:e=>s(s=>({...s,ordenacao:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"ultimaCompra",children:"\xdaltima Compra"}),(0,a.jsx)("option",{value:"nome",children:"Nome"}),(0,a.jsx)("option",{value:"totalCompras",children:"Total de Compras"}),(0,a.jsx)("option",{value:"numeroCompras",children:"N\xfamero de Compras"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dire\xe7\xe3o"}),(0,a.jsxs)("select",{value:e.direcao,onChange:e=>s(s=>({...s,direcao:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"desc",children:"Decrescente"}),(0,a.jsx)("option",{value:"asc",children:"Crescente"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tag"}),(0,a.jsx)("input",{type:"text",placeholder:"Filtrar por tag...",value:e.tag,onChange:e=>s(s=>({...s,tag:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Segmento RFM"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Compras"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Total"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CLV Estimado"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\xdaltima Compra"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map((e,s)=>(0,a.jsxs)(l.P.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},className:"hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,a.jsx)("div",{className:"h-10 w-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-semibold text-sm",children:e.nome.charAt(0).toUpperCase()})})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.nome}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,a.jsx)(j.A,{className:"w-3 h-3 mr-1"}),e.email]}),e.telefone&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 flex items-center",children:[(0,a.jsx)(b.A,{className:"w-3 h-3 mr-1"}),e.telefone]})]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(H(e.rfmSegment)),children:e.rfmSegment})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.numeroCompras})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:K(e.totalCompras)}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Ticket: ",K(e.numeroCompras>0?e.totalCompras/e.numeroCompras:0)]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:K(e.clv||0)})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.ultimaCompra?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(f.A,{className:"w-4 h-4 text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"text-sm text-gray-900",children:Y(e.ultimaCompra)})]}):(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Nunca"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.ativo?"Ativo":"Inativo"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>k(e),className:"text-blue-600 hover:text-blue-900 p-1 rounded",title:"Ver detalhes",children:(0,a.jsx)(N.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"text-gray-400 hover:text-gray-600 p-1 rounded",children:(0,a.jsx)(v.A,{className:"w-4 h-4"})})]})})]},e._id))})]})}),J>1&&(0,a.jsx)("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>M(Math.max(1,E-1)),disabled:1===E,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Anterior"}),(0,a.jsx)("button",{onClick:()=>M(Math.min(J,E+1)),disabled:E===J,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Pr\xf3ximo"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Mostrando"," ",(0,a.jsx)("span",{className:"font-medium",children:(E-1)*20+1})," ","at\xe9"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(20*E,q.length)})," ","de"," ",(0,a.jsx)("span",{className:"font-medium",children:q.length})," ","resultados"]})}),(0,a.jsx)("div",{children:(0,a.jsx)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:Array.from({length:J},(e,s)=>s+1).map(e=>(0,a.jsx)("button",{onClick:()=>M(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(e===E?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},e))})})]})]})})]}),(0,a.jsx)(i.N,{children:t&&(0,a.jsx)(l.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:()=>k(null),children:(0,a.jsx)(l.P.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Detalhes do Cliente"}),(0,a.jsx)("button",{onClick:()=>k(null),className:"text-gray-400 hover:text-gray-600",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Informa\xe7\xf5es B\xe1sicas"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:t.nome})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:t.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Telefone"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:t.telefone||"N\xe3o informado"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(t.ativo?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.ativo?"Ativo":"Inativo"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"M\xe9tricas"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.A,{className:"w-5 h-5 text-blue-500 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-blue-600",children:"Total de Compras"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-blue-900",children:K(t.totalCompras)})]})]})}),(0,a.jsx)("div",{className:"bg-green-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-green-500 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-green-600",children:"N\xfamero de Pedidos"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-green-900",children:t.numeroCompras})]})]})}),(0,a.jsx)("div",{className:"bg-purple-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 text-purple-500 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-purple-600",children:"Ticket M\xe9dio"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-purple-900",children:K(t.numeroCompras>0?t.totalCompras/t.numeroCompras:0)})]})]})}),(0,a.jsx)("div",{className:"bg-orange-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"w-5 h-5 text-orange-500 mr-2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-orange-600",children:"CLV Estimado"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-orange-900",children:K(t.clv||0)})]})]})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Segmenta\xe7\xe3o"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Segmento RFM"}),(0,a.jsx)("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full ".concat(H(t.rfmSegment)),children:t.rfmSegment})]}),t.tags&&t.tags.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.tags.map((e,s)=>(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:[(0,a.jsx)(w.A,{className:"w-3 h-3 mr-1"}),e]},s))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Hist\xf3rico"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Cliente desde"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:Y(t.createdAt)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"\xdaltima compra"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:t.ultimaCompra?Y(t.ultimaCompra):"Nunca"})]})]})]})]})]})})})})]})}},27803:(e,s,t)=>{"use strict";t.d(s,{KO:()=>i,_3:()=>r,q2:()=>l});var a=t(12115);function r(){var e;let[s,t]=(0,a.useState)({data:null,loading:!1,error:null,lastSync:null}),r=(0,a.useCallback)(async(e,s)=>{t(e=>({...e,loading:!0,error:null}));try{let t=new URLSearchParams({type:e,...s}),a=await fetch("/api/crm-integration?".concat(t)),r=await a.json();if(!r.success)throw Error(r.error||"Erro ao buscar dados do CRM");return r.data}catch(s){let e=s instanceof Error?s.message:"Erro desconhecido";throw t(s=>({...s,error:e,loading:!1})),s}},[]),l=(0,a.useCallback)(async(e,s)=>{try{let a={};e&&(a.startDate=e),s&&(a.endDate=s);let l=await r("dashboard",a);return t(e=>({...e,data:l,loading:!1,error:null,lastSync:new Date})),l}catch(e){throw t(e=>({...e,loading:!1})),e}},[r]),i=(0,a.useCallback)(async e=>await r("customers",e),[r]),n=(0,a.useCallback)(async(e,s)=>await r("sales",{startDate:e,endDate:s}),[r]),c=(0,a.useCallback)(async()=>await r("products"),[r]),o=(0,a.useCallback)(async(e,s)=>await r("analytics",{startDate:e,endDate:s}),[r]),d=(0,a.useCallback)(async e=>{t(e=>({...e,loading:!0,error:null}));try{let s=await fetch("/api/crm-integration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"sync-customers",data:{customerIds:e}})}),a=await s.json();if(!a.success)throw Error(a.error||"Erro ao sincronizar clientes");return t(e=>({...e,loading:!1,lastSync:new Date})),a.results}catch(s){let e=s instanceof Error?s.message:"Erro desconhecido";throw t(s=>({...s,error:e,loading:!1})),s}},[]),m=(0,a.useCallback)(async(e,s)=>{try{let t=await fetch("/api/crm-integration",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"update-tags",data:{customerId:e,tags:s}})}),a=await t.json();if(!a.success)throw Error(a.error||"Erro ao atualizar tags");return a.data}catch(s){let e=s instanceof Error?s.message:"Erro desconhecido";throw t(s=>({...s,error:e})),s}},[]);(0,a.useEffect)(()=>{l();let e=setInterval(()=>{l()},3e5);return()=>clearInterval(e)},[l]);let x=(0,a.useCallback)(()=>{l()},[l]),h=(0,a.useCallback)(()=>{t(e=>({...e,error:null}))},[]);return{data:s.data,loading:s.loading,error:s.error,lastSync:s.lastSync,fetchDashboardData:l,fetchCustomers:i,fetchSales:n,fetchProducts:c,fetchAnalytics:o,syncCustomers:d,updateCustomerTags:m,refresh:x,clearError:h,isConnected:!s.error&&null!==s.data,hasData:null!==s.data,metrics:(null==(e=s.data)?void 0:e.metrics)||{totalCustomers:0,totalSales:0,totalProducts:0,averageTicket:0,conversionRate:0}}}function l(){let[e,s]=(0,a.useState)([]),[t,l]=(0,a.useState)(!1),[i,n]=(0,a.useState)(null),{fetchCustomers:c}=r(),o=(0,a.useCallback)(async e=>{l(!0),n(null);try{let t=await c(e);s(t)}catch(e){n(e instanceof Error?e.message:"Erro ao carregar clientes")}finally{l(!1)}},[c]);return(0,a.useEffect)(()=>{o()},[o]),{customers:e,loading:t,error:i,reload:o,total:e.length}}function i(e,s){let[t,l]=(0,a.useState)([]),[i,n]=(0,a.useState)(!1),[c,o]=(0,a.useState)(null),{fetchSales:d}=r(),m=(0,a.useCallback)(async()=>{if(e&&s){n(!0),o(null);try{let t=await d(e,s);l(t)}catch(e){o(e instanceof Error?e.message:"Erro ao carregar vendas")}finally{n(!1)}}},[d,e,s]);return(0,a.useEffect)(()=>{m()},[m]),{sales:t,loading:i,error:c,reload:m,total:t.reduce((e,s)=>e+(s.valor||0),0)}}},78784:(e,s,t)=>{Promise.resolve().then(t.bind(t,8913))}},e=>{e.O(0,[911,55,441,255,358],()=>e(e.s=78784)),_N_E=e.O()}]);